---
title: "R Data Visualization"
author: "Nickie Norris"
output: html_document
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if(!require(MASS)) install.packages("MASS")
if(!require(ggplot2)) install.packages("ggplot2")
require(MASS)
library(MASS)
library(ggplot2)
require(ggplot2)
library(plyr)
library(lattice)
library(MASS)
require(MASS)
```

## High and Low Level Functions

### 2. Create a basic plot using the preloaded cars database. 

```{r, echo = FALSE}
plot(cars)
```

### 3. Edit the cars plot from problem 2 to reflect the following changes:

* main title to "Scatterplot of Speed versus Distance"
* sub title to "Using plot() in R"
* x axis title to "Speed (miles per hour)"
* y axis title to "Stopping Distance (feet)"
* symbol type to closed circle
* symbol color to blue
* axis colors to orange
* axis labels to dark green
* background color to gray
* main title color to red
* symbol size to 1.5
* main title size to 1.5
* x and y axes to 1.5
* axis labels size to 1.5
* subtitle size to 1.5


```{r, echo = FALSE}
plot(cars, main = "Scatterplot of Speed versus Distance", 
    sub = "Using plot() in R", 
    xlab = "Speed (miles per hour)", 
    ylab = "Stopping Distance (feet)", 
    pch = 16, 
    col = "Blue",
    col.axis = "Orange",
    col.lab = "Dark Green",
    col.main = "Red",
    bg = "Gray",
    cex = 1.5,
    cex.main = 1.5,
    cex.axis = 1.5,
    cex.lab = 1.5,
    cex.sub = 1.5
    )
```

### 4. Edit the cars plot further to reflect the following changes:

* turn off the plotting axes
* add a best fit line
* add a grid
* add a box around the plot
* add a legend to the plot

```{r, echo=FALSE}
plot(cars, main = "Scatterplot of Speed versus Distance", 
     sub = "Using plot() in R", 
     xlab = "Speed (miles per hour)", 
     ylab = "Stopping Distance (feet)", 
     pch = 16, 
     col = "Blue",
     col.axis = "Orange",
     col.lab = "Dark Green",
     col.main = "Red",
     bg = "Gray",
     cex = 1.5,
     cex.main = 1.5,
     cex.axis = 1.5,
     cex.lab = 1.5,
     cex.sub = 1.5,
     axes = FALSE,
     abline(lm(dist ~ speed, data = cars)),
     panel.first = grid())
box(which = "plot", lwd = 3,lty = 3, col = "Red")
legend("bottomright", inset = 0.01, title = "Distance vs. Speed", legend = c("Observation"),col=c("blue"),pch=19,horiz=TRUE
       )

```

### 5. Recreate the scatterplot shown in the homework assignment by filling in the blanks. 

**Note:** The image below was generated by saving the data set "Cars" to the working directory and loading the data set from the working directory to render the plot. Because of this I have attached the dataset to the homework submission. 

```{r, echo=FALSE}
load("diamonds.RData")
par(mar = c(5, 7, 5, 5))
plot(diamonds$carat, diamonds$price, 
     col=diamonds$color, 
     pch = 18,
     main = "Scatterplot of Diamond Size versus Price", xlab = "", ylab = "", xlim = c(0,5),
     ylim = c(0,20000), axes = FALSE)
axis(1, c(seq(from = 0, to = 5, by = 0.5)))
axis(2, c(seq(from = 0, to = 20000, by = 5000)), las = 1)
mtext("Size (carats)", side = 1, line = 3)
mtext("Price ($)", side = 2, line = 5)
text(3.5, 20000, "N = 53,940 diamonds")
legend("bottomright", title = "Diamond Color", legend = levels(diamonds$color), col = c("Black", "Red", "Green", "Blue", "Cyan", "Pink", "Yellow"),
       pch = 18, bty = "0"
)

```

### 6.Recreate the scatterplot shown above by filling in the blanks and using **qplot** 

```{r, echo=FALSE}
ggplot2::qplot(carat, price, data = diamonds, colour = color, alpha = I(1/10), 
      main = "Scatterplot of Diamond Sizes versus Price", 
      xlab = "Size (carats)", ylab = "Price ($)"
      )
```

### 7. 
#### How would you describe the relationship between diamond size and price?

If the diamond is small, the price is low whereas if the diamond is larger the price is higher. The graphs shows that the majority of diamonds do not get above 3 carats and the closer to 3 carats the quicker the price jumps up. In other words the difference in price from .5 to 1.5 carats is within 10,000 while the price difference between 2 and 3 carats is closer to 15,000. 

#### How does diamond color factor in?

The diamond colors are represented by the different colors on the graph. THe purple markers appears to be consistently lower in price than the other colors while the red and yellow markers are consistently the most expensive. In other words 15,000 can buy a 1 carat red marker diamond or a 2.5 carat purple marker diamond. Color appears to be a significant factor that determines what a diamond will cost based on its size. 

## Advanced Graphics in R with ggplot

### 1. Describe the data, aestetic mapping, and layers used for each of the following four graphs:

#### Graph 1:

Graph 1 is a scatterplot of mpg for vehicles. The x-axis is city and the y-axis is highway mileage. The plot has a grid background, axis tick marks, and solid data points. 

The general trend is that is a vehicle has poor city mileage it will also have poor highway mileage. If a best fit line was generated a rough ratio of highway to city mpg could be determined. This is a good choice of graph for this type of data. 

```{r, echo=FALSE}
load("mpg.RData")
ggplot(mpg, aes(cty, hwy)) + geom_point()

```

#### Graph 2:

Graph 2 replicates a graph created earlier on diamond data with carat and price as axes. This particular graph has a grid background, axis tick marks, and one color for each data point. The one data point color makes chunks of the graph look solid, meaning it is impossible to tell one data point from another in an area with multiple data points. 

The lack of color for each different color of diamond leads the viewer to believe the data was taken from a sample set of similarly colored diamonds. This graph is useful for a general trend, however color distinction would be very useful to dosplay. 

This is probably the best type of graph for this type of data, however more can be done to improve upon it. 

```{r, echo=FALSE}
ggplot(diamonds, aes(carat, price)) + geom_point()

```

#### Graph 3:

Graph 3 is a line graph that has a small line drawn between each point to create one continuous line. The data shows a pattern of rises and falls that occur at consistent intervals. Overall there is a general positive pattern. 

There is a background grid and axis tick marks. The large number of data points make it difficult to get the exact number of unemployed for any one particular year. 

This is probably the best graph for this type of information. General trends can easily be seen in the plot, however specific points will need to be acquired from the original data. 

```{r, echo=FALSE}
ggplot(economics, aes(date, unemploy)) + geom_line()

```

#### Graph 4:

Graph 4 is a histogram of mpg with city on the x-axis and count on the y-axis. The data has a poisson distribution with a peak near (20, 32). There is a background grid, axis tick marks, and a uniform color for each bar in the graph. The spaced out tick marks and uniform color makes it difficult to identify the count for any one specific city mpg bar. 

```{r, echo=FALSE}
ggplot(mpg, aes(cty)) + geom_histogram()

```

### 3. Iris Data Set

This graph uses the Iris data set and graphs Petal.Length again Petal.Width. This code sets the layout for the scatterplot. 


```{r, echo=FALSE}
plot1 <- ggplot(data = iris, aes(Petal.Length, Petal.Width))
print(plot1)

```

### 4. Create a Scatterplot

This code adds the scatterplot points to the plot. 

```{r, echo=FALSE}
plot2 <- plot1 + geom_point(aes(color = Species))
print(plot2)

```

### 5. Add a Linear Regression

This code adds a linear regression on top of the existing plot. 

```{r, echo=FALSE}
plot3 <- plot2 + geom_smooth(method = "lm")
print(plot3)

```

### 6. Enhance the Plot

This cde adds a title and axis labels to the plot. 

```{r, echo=FALSE}
final <- plot3 +
  xlab("Petal Length (cm)") +
  ylab("Petal Width (cm)") +
  ggtitle("Petal Length versus Width")
plot(final)

```

### 7. Color

I used the final plot and changed colour to red, this changed the color of the linear regression line.  

```{r, echo=FALSE}
final2 <- final +
  (aes(Petal.Length, Petal.Width, colour = "Red"))
final2
```

### 7. Shape

I used the final plot and changed the individual data points from a circle shape to a diamond shape. 

```{r, echo=FALSE}
final3 <- final +
  (aes(Petal.Length, Petal.Width)) + 
  geom_point(shape = 5)
final3
```

### 7. Size

I took the final plot and changed the size to 1.5, the resulting plot enlarges all data points and the linear regression. 


```{r, echo=FALSE}
final4 <- final +
  (aes(Petal.Length, Petal.Width, size = 1.5))
final4
```

### 7. What happens when you map them to continuous values? What happens if you map a continuous value to a shape? Why?

A continuous value cannot be mapped to a shape. I edited the code in "7. Shape" to specify geom_point needed to have shape 5, this made the data points take the new shape while the linear regressio stayed a straight line. 

A continuous value can be given a new size and color though, as can be seen in "7. Size" and "7. Color". 


### 9. Calculate the mean petal length for each species of iris. 

```{r, echo=FALSE}
vert.line <- ddply(iris, .(Species), function(sp) {
  + mean(sp$Petal.Length)})
```

### 10. Create a panel of histograms.

```{r, echo=FALSE}
ggplot(data = iris, aes(x = Petal.Length)) +
  geom_histogram() +
  geom_vline(data = vert.line, aes(xintercept = V1, color = Species)) +
  facet_grid(Species ~ . ) +
  ggtitle("Petal Lengths by Species")

```

### 11. Change one column of three histograms to one row of three histograms.

```{r, echo=FALSE}
ggplot(data = iris, aes(x = Petal.Length)) +
  geom_histogram() +
  geom_vline(data = vert.line, aes(xintercept = V1, color = Species)) +
  facet_grid(. ~ Species ) +
  ggtitle("Petal Lengths by Species")
```

### 12.

```{r, echo=FALSE}
ggplot(data = iris, aes(Petal.Length)) +
  geom_histogram(alpha = 0.2, position = "identity") +
  geom_vline(data = vert.line, aes(xintercept = V1, color = Species)) +
  ggtitle("Petal Lengths by Species Overlay") +
  annotate("segment", x = 4.8, y = 14.5, xend = 4.8, yend = 5, size = 0.5,
             arrow = arrow(length=unit(.2, "cm"))) +
  annotate("text", label = "Overlap", x = 4.8, y = 15, size = 3,
             fontface = "bold")
```

### 13. What happens if you try to facet by a continuous variable (Sepal.Width)?

Faceting by a continuous variable plots numberous lines making the graph difficult to discern as shown below. 

``` {r, echo = FALSE}
ggplot(data = iris, aes(x = Petal.Length)) +
  geom_histogram() +
  geom_vline(data = vert.line, aes(xintercept = V1, color = Species)) +
  facet_grid(. ~ Species ) +
  ggtitle("Petal Lengths by Species")

```

### 14.Using data set mpg create a plot showing the relationship between drive train and fuel ecomony. 

```{r, echo=FALSE}
mpg1 <- ggplot(data = mpg, aes(cty, hwy)) +
  geom_point(aes(color = trans)) +
  ggtitle("Fuel Economy by Drive Train")
mpg1

```

### 14. Using data set pmg create a plot showing the relationship between drive train, engine size, and class. 

```{r, echo=FALSE}
mpg2 <- ggplot(data = mpg, aes(trans, cyl)) +
  geom_point(aes(color = class)) +
  ggtitle("Relationship between Drive Train, Engine Size, and Class")
mpg2

```

### 14. Use faceting to show a three-way relationship between fuel economy, engine size, and number of cylinders. 

```{r, echo=FALSE}
ggplot(data = mpg, aes(x = displ, y = hwy, color = cyl)) + geom_point()

```

### 14. How does faceting change your assessment of the relationship between engine size and fuel economy?

By cyl being color coded it is much easier to see that higher displ and lower cty correlate to a larger engine size. A smaller engine size crrelates to a higher cty and a lower displ. 

### 15. Add a smoothed line to the plot. 

```{r, echo=FALSE}
ggplot(mpg, aes(displ, hwy)) + geom_point() + geom_smooth()
```

### 16.

```{r}
#vignette("ggplot2-specs")
```